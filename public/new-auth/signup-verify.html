<!DOCTYPE html>
<html lang="fa">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../assets/styles/style.css">
</head>

<body dir="rtl"
    class="h-[100svh] flex justify-center md:items-center bg-cover bg-center md:bg-[url(../../new-auth/p.jpg)]">
    <div
        class="bg-my-first flex py-4 gap-3 h-[400px] rounded-2xl  w-[420px] flex-col justify-start items-center md:shadow-2xl px-10">
        <img class="w-30  mb-5" src="../Logo.png" alt="">
        <h1 class="text-xl md:text-xl text-dark-text-Primary text-right mb-2">ایمیل خود را تأیید کنید</h1>
        <span class="text-dark-text-soft opacity-70 text-sm">لطفا کد ارسال شده به <span
                class="text-sm font-extralight">dev.javad.mosavian@gmail.com</span> را وارد کنید</span>
        <form class="w-full space-y-2" action="" method="post">
            <div class="relative z-0 my-2">
                <div dir="ltr" id="inputs" class="flex justify-center gap-3 items-center ">
                    <div>
                        <label for="code-1" class="sr-only">First code</label>
                        <input type="text" maxlength="1" data-focus-input-init data-focus-input-next="code-2"
                            id="code-1" class="digit-input" required autocomplete="off" />
                    </div>
                    <div>
                        <label for="code-2" class="sr-only">Second code</label>
                        <input type="text" maxlength="1" data-focus-input-init data-focus-input-prev="code-1"
                            data-focus-input-next="code-3" id="code-2" class="digit-input" required
                            autocomplete="off" />
                    </div>
                    <div>
                        <label for="code-3" class="sr-only">Third code</label>
                        <input type="text" maxlength="1" data-focus-input-init data-focus-input-prev="code-2"
                            data-focus-input-next="code-4" id="code-3" class="digit-input" required
                            autocomplete="off" />
                    </div>
                    <div>
                        <label for="code-4" class="sr-only">Fourth code</label>
                        <input type="text" maxlength="1" data-focus-input-init data-focus-input-prev="code-3"
                            data-focus-input-next="code-5" id="code-4" class="digit-input" required
                            autocomplete="off" />
                    </div>
                    <div>
                        <label for="code-5" class="sr-only">Fifth code</label>
                        <input type="text" maxlength="1" data-focus-input-init data-focus-input-prev="code-4"
                            data-focus-input-next="code-6" id="code-5" class="digit-input" required
                            autocomplete="off" />
                    </div>
                    <div>
                        <label for="code-6" class="sr-only">Sixth code</label>
                        <input type="text" maxlength="1" data-focus-input-init data-focus-input-prev="code-5"
                            id="code-6" class="digit-input" required autocomplete="off" />
                    </div>
                </div>
            </div>
            <span id="err" class="text-sm text-red-600 hidden">ایمیل شما معتبر نمی باشد!</span>
            <button id="submit" disabled
                class="bg-my-second mt-5 transition-all cursor-pointer duration-300 hover:bg-opacity-90 text-lg font-bold py-1 rounded-sm w-full text-light-text-soft disabled:opacity-50 disabled:cursor-not-allowed disabled:grayscale-100"
                aria-label="Continue with email">ادامه</button>

        </form>
        

        <div class="mt-auto flex flex-col items-center gap-3">
            <button disabled
            class="disabled:text-dark-text-soft/70 text-sm text-center w-full select-none enabled:cursor-pointer text-blue-600 enabled:hover:underline">ارسال
            مجدد کد در <span id="timer"></span> ثانیه دیگر.</button>
        </div>
    </div>



    <script src="../assets/scripts/alert.js"></script>
    <script src="../assets/scripts/digit-inputs.js"></script>
    <script>

        const button = document.querySelector('#submit');
        const err = document.querySelector('#err');
        const form = document.querySelector("form");

        const digits = document.querySelectorAll('#inputs input');
        digits.forEach((digit) => {
            digit.addEventListener("input", (e) => {
                digit.value = digit.value.replace(/[^0-9]/g, '');
                button.disabled = !valid();
            });
        });

        function valid() {
            var is = 0;
            for (let digit of digits) {
                if (digit.value == null || digit.value == "") {
                    break;
                } else {
                    is++;
                }
            }
            if (is === 6) {
                return true;
            } else {
                is = 0;
                return false;
            }
        }

        form.addEventListener('submit', (e) => {
            if(valid() === false){
                err.classList.remove("hidden");
                button.disabled = !valid();
                e.preventDefault();
            }
        });

        const timer = document.getElementById("timer");
        var time = 5;
        function setTimer() {
            if (time >= 1) {
                setTimeout(() => {
                    time--;
                    timerText();
                }, 1000)
            } else {
                console.log("end");
                timer.parentNode.disabled = false;
                timer.parentNode.innerHTML = "ارسال کد";
            }

        }

        function timerText() {
            timer.innerHTML = time;
            setTimer();
        }

        timerText();
    </script>
</body>

</html>